[2025-07-16 12:19:52] Starting CNN Execution Time Prediction Training
[2025-07-16 12:19:52] Using device: cuda
[2025-07-16 12:19:52] GPU: NVIDIA L40S
[2025-07-16 12:19:52] GPU Memory: 44.4 GB
[2025-07-16 12:19:52] CUDA version: 12.4
[2025-07-16 12:19:52] Loading data from combined.csv
[2025-07-16 12:19:52] Data loaded successfully. Shape: (77000, 9)
[2025-07-16 12:19:52] Scaling numerical features: ['Batch_Size', 'Input_Size', 'In_Channels', 'Out_Channels', 'Kernel_Size', 'Stride', 'Padding']
[2025-07-16 12:19:52] Features: 9
[2025-07-16 12:19:52] Feature columns: ['Batch_Size', 'Input_Size', 'In_Channels', 'Out_Channels', 'Kernel_Size', 'Stride', 'Padding', 'Algorithm_direct', 'Algorithm_smm']
[2025-07-16 12:19:52] Data preprocessing complete. Features shape: (77000, 9), Target shape: (77000,)
[2025-07-16 12:19:52] Training with 5-Fold Cross Validation
[2025-07-16 12:19:52] Total samples: 77000
[2025-07-16 12:19:52] Features: 9
[2025-07-16 12:19:52] Preparing FOLD 1
[2025-07-16 12:19:52] Training samples: 61600
[2025-07-16 12:19:52] Validation samples: 15400
[2025-07-16 12:19:52] Preparing FOLD 2
[2025-07-16 12:19:52] Training samples: 61600
[2025-07-16 12:19:52] Validation samples: 15400
[2025-07-16 12:19:52] Preparing FOLD 3
[2025-07-16 12:19:52] Training samples: 61600
[2025-07-16 12:19:52] Validation samples: 15400
[2025-07-16 12:19:52] Preparing FOLD 4
[2025-07-16 12:19:52] Training samples: 61600
[2025-07-16 12:19:52] Validation samples: 15400
[2025-07-16 12:19:52] Preparing FOLD 5
[2025-07-16 12:19:52] Training samples: 61600
[2025-07-16 12:19:52] Validation samples: 15400
[2025-07-16 12:19:52] Starting 5-Fold Cross Validation Training
[2025-07-16 12:19:52] Epochs: 250, Early Stopping Patience: 30
[2025-07-16 12:19:52] Learning Rate: 0.001
[2025-07-16 12:19:52] ================================================================================
[2025-07-16 12:19:52] Starting FOLD 1
[2025-07-16 12:19:52] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 12:20:31]   Epoch  10/250 | Train Loss: 25.9485 | Val Loss: 23.6735 | Val MAPE: 23.70% | Time: 3.01s
[2025-07-16 12:21:01]   Epoch  20/250 | Train Loss: 24.1380 | Val Loss: 24.3439 | Val MAPE: 24.37% | Time: 2.99s
[2025-07-16 12:21:31]   Epoch  30/250 | Train Loss: 21.9993 | Val Loss: 29.0169 | Val MAPE: 29.04% | Time: 3.00s
[2025-07-16 12:22:01]   Epoch  40/250 | Train Loss: 21.1053 | Val Loss: 25.4190 | Val MAPE: 25.45% | Time: 3.01s
[2025-07-16 12:22:10]   Early stopping at epoch 43
[2025-07-16 12:22:11]   Fold 1 Complete in 138.83 seconds
[2025-07-16 12:22:11]      Train MAPE: 29.67% | Val MAPE: 29.93%
[2025-07-16 12:22:11]      Train MAE:  18.6645 | Val MAE:  19.2149
[2025-07-16 12:22:11]      Train RÂ²:   0.3721 | Val RÂ²:   0.3531
[2025-07-16 12:22:11]      Epochs:     43/250
[2025-07-16 12:22:11] Starting FOLD 2
[2025-07-16 12:22:11] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 12:22:41]   Epoch  10/250 | Train Loss: 26.0121 | Val Loss: 22.7698 | Val MAPE: 22.79% | Time: 3.01s
[2025-07-16 12:23:11]   Epoch  20/250 | Train Loss: 23.8419 | Val Loss: 23.3148 | Val MAPE: 23.33% | Time: 3.01s
[2025-07-16 12:23:41]   Epoch  30/250 | Train Loss: 22.1549 | Val Loss: 25.9007 | Val MAPE: 25.93% | Time: 3.01s
[2025-07-16 12:24:11]   Epoch  40/250 | Train Loss: 21.1693 | Val Loss: 28.3206 | Val MAPE: 28.35% | Time: 3.02s
[2025-07-16 12:24:14]   Early stopping at epoch 41
[2025-07-16 12:24:15]   Fold 2 Complete in 124.42 seconds
[2025-07-16 12:24:15]      Train MAPE: 25.53% | Val MAPE: 25.24%
[2025-07-16 12:24:15]      Train MAE:  18.7184 | Val MAE:  19.2328
[2025-07-16 12:24:15]      Train RÂ²:   0.3294 | Val RÂ²:   0.3436
[2025-07-16 12:24:15]      Epochs:     41/250
[2025-07-16 12:24:15] Starting FOLD 3
[2025-07-16 12:24:15] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 12:24:45]   Epoch  10/250 | Train Loss: 26.3630 | Val Loss: 22.8000 | Val MAPE: 22.81% | Time: 3.01s
[2025-07-16 12:25:15]   Epoch  20/250 | Train Loss: 24.3295 | Val Loss: 26.5921 | Val MAPE: 26.60% | Time: 3.02s
[2025-07-16 12:25:45]   Epoch  30/250 | Train Loss: 22.3898 | Val Loss: 24.9218 | Val MAPE: 24.94% | Time: 3.02s
[2025-07-16 12:26:16]   Epoch  40/250 | Train Loss: 21.7196 | Val Loss: 23.6894 | Val MAPE: 23.70% | Time: 3.01s
[2025-07-16 12:26:46]   Epoch  50/250 | Train Loss: 20.7051 | Val Loss: 23.7598 | Val MAPE: 23.78% | Time: 3.02s
[2025-07-16 12:27:13]   Early stopping at epoch 59
[2025-07-16 12:27:14]   Fold 3 Complete in 178.73 seconds
[2025-07-16 12:27:14]      Train MAPE: 27.20% | Val MAPE: 27.01%
[2025-07-16 12:27:14]      Train MAE:  18.6124 | Val MAE:  17.4921
[2025-07-16 12:27:14]      Train RÂ²:   0.3610 | Val RÂ²:   0.3652
[2025-07-16 12:27:14]      Epochs:     59/250
[2025-07-16 12:27:14] Starting FOLD 4
[2025-07-16 12:27:14] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 12:27:44]   Epoch  10/250 | Train Loss: 26.1453 | Val Loss: 24.6746 | Val MAPE: 24.70% | Time: 3.02s
[2025-07-16 12:28:14]   Epoch  20/250 | Train Loss: 23.3163 | Val Loss: 23.7927 | Val MAPE: 23.81% | Time: 3.01s
[2025-07-16 12:28:44]   Epoch  30/250 | Train Loss: 22.2628 | Val Loss: 26.6897 | Val MAPE: 26.72% | Time: 3.01s
[2025-07-16 12:29:09]   Early stopping at epoch 38
[2025-07-16 12:29:09]   Fold 4 Complete in 115.58 seconds
[2025-07-16 12:29:09]      Train MAPE: 24.18% | Val MAPE: 24.24%
[2025-07-16 12:29:09]      Train MAE:  18.2087 | Val MAE:  19.3323
[2025-07-16 12:29:09]      Train RÂ²:   0.3539 | Val RÂ²:   0.3226
[2025-07-16 12:29:09]      Epochs:     38/250
[2025-07-16 12:29:09] Starting FOLD 5
[2025-07-16 12:29:09] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 12:29:40]   Epoch  10/250 | Train Loss: 26.4429 | Val Loss: 26.7271 | Val MAPE: 26.75% | Time: 3.02s
[2025-07-16 12:30:10]   Epoch  20/250 | Train Loss: 23.5887 | Val Loss: 25.0452 | Val MAPE: 25.07% | Time: 3.04s
[2025-07-16 12:30:40]   Epoch  30/250 | Train Loss: 21.9874 | Val Loss: 24.2731 | Val MAPE: 24.30% | Time: 3.04s
[2025-07-16 12:30:52]   Early stopping at epoch 34
[2025-07-16 12:30:53]   Fold 5 Complete in 103.87 seconds
[2025-07-16 12:30:53]      Train MAPE: 24.00% | Val MAPE: 24.23%
[2025-07-16 12:30:53]      Train MAE:  19.2724 | Val MAE:  18.3835
[2025-07-16 12:30:53]      Train RÂ²:   0.2892 | Val RÂ²:   0.3240
[2025-07-16 12:30:53]      Epochs:     34/250
[2025-07-16 12:30:53] 
================================================================================
[2025-07-16 12:30:53] ðŸ“Š CROSS VALIDATION SUMMARY
[2025-07-16 12:30:53] ================================================================================
[2025-07-16 12:30:53] Average Train MAPE: 26.12%
[2025-07-16 12:30:53] Average Val MAPE:   26.13% Â± 2.15%
[2025-07-16 12:30:53] Average Train MAE:  18.6953
[2025-07-16 12:30:53] Average Val MAE:    18.7311 Â± 0.7075
[2025-07-16 12:30:53] Average Train RÂ²:   0.3411
[2025-07-16 12:30:53] Average Val RÂ²:     0.3417 Â± 0.0165
[2025-07-16 12:30:53] Average Training Time per Fold: 132.29 seconds
[2025-07-16 12:30:53] Total Training Time: 661.44 seconds (11.02 minutes)
[2025-07-16 12:30:53] 
Detailed Results by Fold:
[2025-07-16 12:30:53] Fold Train MAPE  Val MAPE  Train RÂ² Val RÂ²  Epochs  Time(s) 
[2025-07-16 12:30:53] ----------------------------------------------------------------------
[2025-07-16 12:30:53] 1    29.67       29.93     0.3721   0.3531  43      138.83  
[2025-07-16 12:30:53] 2    25.53       25.24     0.3294   0.3436  41      124.42  
[2025-07-16 12:30:53] 3    27.20       27.01     0.3610   0.3652  59      178.73  
[2025-07-16 12:30:53] 4    24.18       24.24     0.3539   0.3226  38      115.58  
[2025-07-16 12:30:53] 5    24.00       24.23     0.2892   0.3240  34      103.87  
[2025-07-16 12:30:53] 
ðŸŽ‰ Training Complete!
[2025-07-16 12:30:53] ðŸ“ˆ Best performing fold: Fold 5 (Val MAPE: 24.23%)
[2025-07-16 12:30:53] Results saved to training_results.csv
[2025-07-16 12:30:53] Best model saved to best_model.pth
[2025-07-16 12:30:53] Creating evaluation plots...
[2025-07-16 12:30:53] Collecting predictions for visualization...
[2025-07-16 12:30:56] Main evaluation plot saved to nn_training_evaluation.png
[2025-07-16 12:30:57] Detailed metrics plot saved to nn_detailed_metrics.png
[2025-07-16 12:30:58] Cross-validation comparison plot saved to nn_cross_validation_comparison.png
[2025-07-16 12:30:58] 
================================================================================
[2025-07-16 12:30:58] ðŸ“Š VISUALIZATION SUMMARY
[2025-07-16 12:30:58] ================================================================================
[2025-07-16 12:30:58] Generated evaluation plots:
[2025-07-16 12:30:58]   1. nn_training_evaluation.png - Main evaluation dashboard (6 plots)
[2025-07-16 12:30:58]      â€¢ Training/Validation loss curves
[2025-07-16 12:30:58]      â€¢ Prediction vs Actual scatter plot
[2025-07-16 12:30:58]      â€¢ Residual analysis
[2025-07-16 12:30:58]      â€¢ MAPE over epochs
[2025-07-16 12:30:58]      â€¢ Cross-validation results
[2025-07-16 12:30:58]      â€¢ Error distribution
[2025-07-16 12:30:58]   2. nn_detailed_metrics.png - Detailed metrics (4 plots)
[2025-07-16 12:30:58]      â€¢ RÂ² progression
[2025-07-16 12:30:58]      â€¢ MAE progression
[2025-07-16 12:30:58]      â€¢ Learning rate schedule
[2025-07-16 12:30:58]      â€¢ Residual distribution
[2025-07-16 12:30:58]   3. nn_cross_validation_comparison.png - CV analysis (6 plots)
[2025-07-16 12:30:58]      â€¢ Metric comparisons across folds
[2025-07-16 12:30:58]      â€¢ Training times and epochs
[2025-07-16 12:30:58]      â€¢ Summary statistics
[2025-07-16 12:30:58] GPU memory cleared
[2025-07-16 12:30:58] Script completed successfully!
