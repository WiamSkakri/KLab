[2025-07-16 10:17:19] Starting CNN Execution Time Prediction Training
[2025-07-16 10:17:19] Using device: cuda
[2025-07-16 10:17:19] GPU: NVIDIA L40S
[2025-07-16 10:17:19] GPU Memory: 44.4 GB
[2025-07-16 10:17:19] CUDA version: 12.4
[2025-07-16 10:17:19] Loading data from combined.csv
[2025-07-16 10:17:19] Data loaded successfully. Shape: (77000, 9)
[2025-07-16 10:17:19] Scaling numerical features: ['Batch_Size', 'Input_Size', 'In_Channels', 'Out_Channels', 'Kernel_Size', 'Stride', 'Padding']
[2025-07-16 10:17:19] Features: 9
[2025-07-16 10:17:19] Feature columns: ['Batch_Size', 'Input_Size', 'In_Channels', 'Out_Channels', 'Kernel_Size', 'Stride', 'Padding', 'Algorithm_direct', 'Algorithm_smm']
[2025-07-16 10:17:19] Data preprocessing complete. Features shape: (77000, 9), Target shape: (77000,)
[2025-07-16 10:17:19] Training with 5-Fold Cross Validation
[2025-07-16 10:17:19] Total samples: 77000
[2025-07-16 10:17:19] Features: 9
[2025-07-16 10:17:19] Preparing FOLD 1
[2025-07-16 10:17:19] Training samples: 61600
[2025-07-16 10:17:19] Validation samples: 15400
[2025-07-16 10:17:19] Preparing FOLD 2
[2025-07-16 10:17:19] Training samples: 61600
[2025-07-16 10:17:19] Validation samples: 15400
[2025-07-16 10:17:19] Preparing FOLD 3
[2025-07-16 10:17:19] Training samples: 61600
[2025-07-16 10:17:19] Validation samples: 15400
[2025-07-16 10:17:19] Preparing FOLD 4
[2025-07-16 10:17:19] Training samples: 61600
[2025-07-16 10:17:19] Validation samples: 15400
[2025-07-16 10:17:19] Preparing FOLD 5
[2025-07-16 10:17:19] Training samples: 61600
[2025-07-16 10:17:19] Validation samples: 15400
[2025-07-16 10:17:19] Starting 5-Fold Cross Validation Training
[2025-07-16 10:17:19] Epochs: 250, Early Stopping Patience: 30
[2025-07-16 10:17:19] Learning Rate: 0.001
[2025-07-16 10:17:19] ================================================================================
[2025-07-16 10:17:19] Starting FOLD 1
[2025-07-16 10:17:19] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 10:17:48]   Epoch  10/250 | Train Loss: 4939.9212 | Val Loss: 3905.7094 | Val MAPE: 41.81% | Time: 2.72s
[2025-07-16 10:18:16]   Epoch  20/250 | Train Loss: 3909.3108 | Val Loss: 8029.5225 | Val MAPE: 38.86% | Time: 2.69s
[2025-07-16 10:18:43]   Epoch  30/250 | Train Loss: 3400.6038 | Val Loss: 1904.2455 | Val MAPE: 42.68% | Time: 2.74s
[2025-07-16 10:19:11]   Epoch  40/250 | Train Loss: 2645.7569 | Val Loss: 1883.3256 | Val MAPE: 35.45% | Time: 2.71s
[2025-07-16 10:19:38]   Epoch  50/250 | Train Loss: 2643.7636 | Val Loss: 964.3294 | Val MAPE: 36.57% | Time: 2.73s
[2025-07-16 10:20:05]   Epoch  60/250 | Train Loss: 2122.6629 | Val Loss: 2429.2134 | Val MAPE: 35.02% | Time: 2.79s
[2025-07-16 10:20:33]   Epoch  70/250 | Train Loss: 2143.6970 | Val Loss: 751.2546 | Val MAPE: 33.56% | Time: 2.75s
[2025-07-16 10:21:00]   Epoch  80/250 | Train Loss: 1854.1201 | Val Loss: 1588.7121 | Val MAPE: 31.84% | Time: 2.77s
[2025-07-16 10:21:28]   Epoch  90/250 | Train Loss: 1713.2794 | Val Loss: 1181.6887 | Val MAPE: 32.04% | Time: 2.74s
[2025-07-16 10:21:55]   Epoch 100/250 | Train Loss: 1622.8451 | Val Loss: 1221.6579 | Val MAPE: 34.71% | Time: 2.73s
[2025-07-16 10:22:22]   Epoch 110/250 | Train Loss: 1536.0465 | Val Loss: 1302.3952 | Val MAPE: 30.88% | Time: 2.69s
[2025-07-16 10:22:50]   Epoch 120/250 | Train Loss: 1435.3366 | Val Loss: 1378.1770 | Val MAPE: 32.72% | Time: 2.73s
[2025-07-16 10:23:17]   Epoch 130/250 | Train Loss: 1429.5610 | Val Loss: 706.4919 | Val MAPE: 33.76% | Time: 2.69s
[2025-07-16 10:23:45]   Epoch 140/250 | Train Loss: 1446.1609 | Val Loss: 1365.8005 | Val MAPE: 32.03% | Time: 2.76s
[2025-07-16 10:24:12]   Epoch 150/250 | Train Loss: 1178.0594 | Val Loss: 1008.9544 | Val MAPE: 30.02% | Time: 2.76s
[2025-07-16 10:24:15]   Early stopping at epoch 151
[2025-07-16 10:24:15]   Fold 1 Complete in 416.34 seconds
[2025-07-16 10:24:15]      Train MAPE: 31.98% | Val MAPE: 32.10%
[2025-07-16 10:24:15]      Train MAE:  8.5422 | Val MAE:  8.6281
[2025-07-16 10:24:15]      Train R²:   0.9475 | Val R²:   0.9467
[2025-07-16 10:24:15]      Epochs:     151/250
[2025-07-16 10:24:15] Starting FOLD 2
[2025-07-16 10:24:15] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 10:24:43]   Epoch  10/250 | Train Loss: 4834.3845 | Val Loss: 3594.6736 | Val MAPE: 45.03% | Time: 2.74s
[2025-07-16 10:25:10]   Epoch  20/250 | Train Loss: 3774.2686 | Val Loss: 2639.6961 | Val MAPE: 33.74% | Time: 2.72s
[2025-07-16 10:25:37]   Epoch  30/250 | Train Loss: 2679.4844 | Val Loss: 888.4905 | Val MAPE: 30.60% | Time: 2.75s
[2025-07-16 10:26:05]   Epoch  40/250 | Train Loss: 2584.7052 | Val Loss: 2573.1336 | Val MAPE: 34.49% | Time: 2.73s
[2025-07-16 10:26:32]   Epoch  50/250 | Train Loss: 2233.9346 | Val Loss: 1303.8629 | Val MAPE: 27.91% | Time: 2.75s
[2025-07-16 10:27:00]   Epoch  60/250 | Train Loss: 1902.5454 | Val Loss: 1139.5891 | Val MAPE: 32.49% | Time: 2.81s
[2025-07-16 10:27:27]   Epoch  70/250 | Train Loss: 1719.1076 | Val Loss: 896.0668 | Val MAPE: 34.06% | Time: 2.72s
[2025-07-16 10:27:55]   Epoch  80/250 | Train Loss: 1801.9781 | Val Loss: 1324.6469 | Val MAPE: 33.80% | Time: 2.81s
[2025-07-16 10:28:06]   Early stopping at epoch 84
[2025-07-16 10:28:07]   Fold 2 Complete in 231.32 seconds
[2025-07-16 10:28:07]      Train MAPE: 32.93% | Val MAPE: 33.23%
[2025-07-16 10:28:07]      Train MAE:  8.7658 | Val MAE:  9.1010
[2025-07-16 10:28:07]      Train R²:   0.9486 | Val R²:   0.9470
[2025-07-16 10:28:07]      Epochs:     84/250
[2025-07-16 10:28:07] Starting FOLD 3
[2025-07-16 10:28:07] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 10:28:33]   Epoch  10/250 | Train Loss: 5079.1090 | Val Loss: 3688.6456 | Val MAPE: 42.96% | Time: 2.66s
[2025-07-16 10:29:00]   Epoch  20/250 | Train Loss: 3939.6790 | Val Loss: 4552.1850 | Val MAPE: 33.29% | Time: 2.67s
[2025-07-16 10:29:26]   Epoch  30/250 | Train Loss: 3596.4526 | Val Loss: 2228.3965 | Val MAPE: 34.85% | Time: 2.65s
[2025-07-16 10:29:53]   Epoch  40/250 | Train Loss: 3519.8209 | Val Loss: 3937.1853 | Val MAPE: 41.22% | Time: 2.63s
[2025-07-16 10:30:19]   Epoch  50/250 | Train Loss: 2846.4077 | Val Loss: 1276.1645 | Val MAPE: 34.66% | Time: 2.63s
[2025-07-16 10:30:46]   Epoch  60/250 | Train Loss: 2244.2857 | Val Loss: 1852.7738 | Val MAPE: 40.40% | Time: 2.65s
[2025-07-16 10:31:13]   Epoch  70/250 | Train Loss: 2099.6669 | Val Loss: 620.7012 | Val MAPE: 33.32% | Time: 2.65s
[2025-07-16 10:31:39]   Epoch  80/250 | Train Loss: 2427.1465 | Val Loss: 1408.6659 | Val MAPE: 37.53% | Time: 2.69s
[2025-07-16 10:32:06]   Epoch  90/250 | Train Loss: 1875.1561 | Val Loss: 1028.5179 | Val MAPE: 40.95% | Time: 2.68s
[2025-07-16 10:32:33]   Epoch 100/250 | Train Loss: 1727.9812 | Val Loss: 950.3369 | Val MAPE: 37.22% | Time: 2.65s
[2025-07-16 10:32:49]   Early stopping at epoch 106
[2025-07-16 10:32:50]   Fold 3 Complete in 282.90 seconds
[2025-07-16 10:32:50]      Train MAPE: 35.58% | Val MAPE: 35.76%
[2025-07-16 10:32:50]      Train MAE:  9.7192 | Val MAE:  9.2736
[2025-07-16 10:32:50]      Train R²:   0.9174 | Val R²:   0.9255
[2025-07-16 10:32:50]      Epochs:     106/250
[2025-07-16 10:32:50] Starting FOLD 4
[2025-07-16 10:32:50] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 10:33:16]   Epoch  10/250 | Train Loss: 4545.7886 | Val Loss: 3440.1430 | Val MAPE: 43.15% | Time: 2.67s
[2025-07-16 10:33:43]   Epoch  20/250 | Train Loss: 3656.5277 | Val Loss: 7144.8928 | Val MAPE: 45.14% | Time: 2.65s
[2025-07-16 10:34:10]   Epoch  30/250 | Train Loss: 2882.4684 | Val Loss: 3849.9984 | Val MAPE: 40.86% | Time: 2.72s
[2025-07-16 10:34:37]   Epoch  40/250 | Train Loss: 3035.1998 | Val Loss: 1971.7392 | Val MAPE: 38.11% | Time: 2.64s
[2025-07-16 10:35:04]   Epoch  50/250 | Train Loss: 2902.0061 | Val Loss: 2047.1070 | Val MAPE: 39.19% | Time: 2.68s
[2025-07-16 10:35:30]   Epoch  60/250 | Train Loss: 2708.6830 | Val Loss: 3073.4272 | Val MAPE: 37.59% | Time: 2.70s
[2025-07-16 10:35:57]   Epoch  70/250 | Train Loss: 2229.9633 | Val Loss: 2117.0997 | Val MAPE: 34.91% | Time: 2.68s
[2025-07-16 10:36:24]   Epoch  80/250 | Train Loss: 1845.4274 | Val Loss: 1532.2087 | Val MAPE: 36.22% | Time: 2.67s
[2025-07-16 10:36:40]   Early stopping at epoch 86
[2025-07-16 10:36:41]   Fold 4 Complete in 231.12 seconds
[2025-07-16 10:36:41]      Train MAPE: 33.71% | Val MAPE: 33.94%
[2025-07-16 10:36:41]      Train MAE:  9.3500 | Val MAE:  9.6283
[2025-07-16 10:36:41]      Train R²:   0.9337 | Val R²:   0.9290
[2025-07-16 10:36:41]      Epochs:     86/250
[2025-07-16 10:36:41] Starting FOLD 5
[2025-07-16 10:36:41] ----------------------------------------
/home/wxs428/ai3_env/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[2025-07-16 10:37:07]   Epoch  10/250 | Train Loss: 4930.7259 | Val Loss: 3476.5203 | Val MAPE: 34.51% | Time: 2.65s
[2025-07-16 10:37:34]   Epoch  20/250 | Train Loss: 3811.8863 | Val Loss: 1681.9510 | Val MAPE: 39.53% | Time: 2.65s
[2025-07-16 10:38:00]   Epoch  30/250 | Train Loss: 4017.9871 | Val Loss: 2232.2767 | Val MAPE: 36.14% | Time: 2.72s
[2025-07-16 10:38:27]   Epoch  40/250 | Train Loss: 2497.6656 | Val Loss: 2482.3567 | Val MAPE: 33.91% | Time: 2.63s
[2025-07-16 10:38:54]   Epoch  50/250 | Train Loss: 2474.2805 | Val Loss: 2228.7803 | Val MAPE: 32.65% | Time: 2.66s
[2025-07-16 10:39:20]   Epoch  60/250 | Train Loss: 2269.6921 | Val Loss: 1964.6096 | Val MAPE: 34.11% | Time: 2.69s
[2025-07-16 10:39:47]   Epoch  70/250 | Train Loss: 1974.3990 | Val Loss: 1134.5548 | Val MAPE: 35.14% | Time: 2.69s
[2025-07-16 10:40:14]   Epoch  80/250 | Train Loss: 1730.4639 | Val Loss: 926.7325 | Val MAPE: 36.03% | Time: 2.73s
[2025-07-16 10:40:42]   Epoch  90/250 | Train Loss: 1859.5418 | Val Loss: 1045.9448 | Val MAPE: 36.28% | Time: 2.74s
[2025-07-16 10:41:09]   Epoch 100/250 | Train Loss: 1528.0000 | Val Loss: 648.2570 | Val MAPE: 32.39% | Time: 2.70s
[2025-07-16 10:41:36]   Epoch 110/250 | Train Loss: 1575.9949 | Val Loss: 785.4750 | Val MAPE: 36.21% | Time: 2.67s
[2025-07-16 10:41:52]   Early stopping at epoch 116
[2025-07-16 10:41:53]   Fold 5 Complete in 311.90 seconds
[2025-07-16 10:41:53]      Train MAPE: 35.25% | Val MAPE: 34.69%
[2025-07-16 10:41:53]      Train MAE:  8.4531 | Val MAE:  8.2205
[2025-07-16 10:41:53]      Train R²:   0.9443 | Val R²:   0.9472
[2025-07-16 10:41:53]      Epochs:     116/250
[2025-07-16 10:41:53] 
================================================================================
[2025-07-16 10:41:53] 📊 CROSS VALIDATION SUMMARY
[2025-07-16 10:41:53] ================================================================================
[2025-07-16 10:41:53] Average Train MAPE: 33.89%
[2025-07-16 10:41:53] Average Val MAPE:   33.94% ± 1.25%
[2025-07-16 10:41:53] Average Train MAE:  8.9661
[2025-07-16 10:41:53] Average Val MAE:    8.9703 ± 0.4942
[2025-07-16 10:41:53] Average Train R²:   0.9383
[2025-07-16 10:41:53] Average Val R²:     0.9391 ± 0.0097
[2025-07-16 10:41:53] Average Training Time per Fold: 294.71 seconds
[2025-07-16 10:41:53] Total Training Time: 1473.57 seconds (24.56 minutes)
[2025-07-16 10:41:53] 
Detailed Results by Fold:
[2025-07-16 10:41:53] Fold Train MAPE  Val MAPE  Train R² Val R²  Epochs  Time(s) 
[2025-07-16 10:41:53] ----------------------------------------------------------------------
[2025-07-16 10:41:53] 1    31.98       32.10     0.9475   0.9467  151     416.34  
[2025-07-16 10:41:53] 2    32.93       33.23     0.9486   0.9470  84      231.32  
[2025-07-16 10:41:53] 3    35.58       35.76     0.9174   0.9255  106     282.90  
[2025-07-16 10:41:53] 4    33.71       33.94     0.9337   0.9290  86      231.12  
[2025-07-16 10:41:53] 5    35.25       34.69     0.9443   0.9472  116     311.90  
[2025-07-16 10:41:53] 
🎉 Training Complete!
[2025-07-16 10:41:53] 📈 Best performing fold: Fold 1 (Val MAPE: 32.10%)
[2025-07-16 10:41:53] Results saved to training_results.csv
[2025-07-16 10:41:53] Best model saved to best_model.pth
[2025-07-16 10:41:53] Creating evaluation plots...
[2025-07-16 10:41:53] Collecting predictions for visualization...
[2025-07-16 10:41:55] Main evaluation plot saved to nn_training_evaluation.png
[2025-07-16 10:41:56] Detailed metrics plot saved to nn_detailed_metrics.png
[2025-07-16 10:41:57] Cross-validation comparison plot saved to nn_cross_validation_comparison.png
[2025-07-16 10:41:57] 
================================================================================
[2025-07-16 10:41:57] 📊 VISUALIZATION SUMMARY
[2025-07-16 10:41:57] ================================================================================
[2025-07-16 10:41:57] Generated evaluation plots:
[2025-07-16 10:41:57]   1. nn_training_evaluation.png - Main evaluation dashboard (6 plots)
[2025-07-16 10:41:57]      • Training/Validation loss curves
[2025-07-16 10:41:57]      • Prediction vs Actual scatter plot
[2025-07-16 10:41:57]      • Residual analysis
[2025-07-16 10:41:57]      • MAPE over epochs
[2025-07-16 10:41:57]      • Cross-validation results
[2025-07-16 10:41:57]      • Error distribution
[2025-07-16 10:41:57]   2. nn_detailed_metrics.png - Detailed metrics (4 plots)
[2025-07-16 10:41:57]      • R² progression
[2025-07-16 10:41:57]      • MAE progression
[2025-07-16 10:41:57]      • Learning rate schedule
[2025-07-16 10:41:57]      • Residual distribution
[2025-07-16 10:41:57]   3. nn_cross_validation_comparison.png - CV analysis (6 plots)
[2025-07-16 10:41:57]      • Metric comparisons across folds
[2025-07-16 10:41:57]      • Training times and epochs
[2025-07-16 10:41:57]      • Summary statistics
[2025-07-16 10:41:57] GPU memory cleared
[2025-07-16 10:41:57] Script completed successfully!
